<!DOCTYPE html>
<html lang="en">
<head>
  {{template "app/skylab/head.html"}}
  <title>{{$.TeamEvaluation.Evaluatee.Team.TeamName}} | {{SkylabMilestoneNameAbbrev $.TeamEvaluation.EvaluationForm.Period.Milestone}} Evaluation</title>
</head>
<body class="{{if SkylabCurrentRole}}tripanel-l{{else}}bipanel-l{{end}}">
  {{template "app/skylab/navbar.html"}}
  {{template "app/skylab/sidebar.html"}}
  <div class="sans-serif pa2 pa4-l">
    <div class="widget pa4">
      {{template "helpers/flash/flash.html"}}
      <div class="mb3 flex justify-between">
        <div>
          <a href="?layout=adjacent" class="no-underline">
            <button class="button f6 pv1 ph2 bg-light-red hover-bg-red">side-by-side</button>
          </a>
          <span class="ph2"></span>
          <a href="{{$.SubmissionURL}}" class="no-underline">
            <button class="button f6 pv1 ph2 bg-light-red hover-bg-red">submission</button>
          </a>
        </div>
        {{if $.PreviewURL}}
          <button type="submit" form="evaluationform" formaction="{{$.PreviewURL}}" class="button f6 ph2 pv1 bg-light-green hover-bg-green">
            Update &amp; Preview
          </button>
        {{end}}
      </div>
      <h4 class="ma0">{{SkylabMilestoneName $.TeamEvaluation.EvaluationForm.Period.Milestone}} Evaluation</h4>
      <div class="">
        My Team &rarr;
        evaluating <span class="gray">[{{$.TeamEvaluation.Evaluatee.Team.TeamID}}] [{{$.TeamEvaluation.Evaluatee.Team.ProjectLevel}}]</span>
        &nbsp;{{$.TeamEvaluation.Evaluatee.Team.TeamName}}
      </div>
      {{if $.TeamEvaluation.Submitted}}
        <div class="gray">Submitted</div>
      {{else}}
        <div class="gray">Draft</div>
      {{end}}
      <div class="pv3"></div>
      <form id="evaluationform" method="post" action="{{.UpdateURL}}">
        {{SkylabCsrfToken}}
        {{$evaluationData := FormxMergeQuestionsAnswers $.TeamEvaluation.EvaluationForm.Questions $.TeamEvaluation.EvaluationAnswers}}
        {{template "helpers/formx/render_form.html" $evaluationData}}
        <div class="">
          {{if $.TeamEvaluation.Submitted}}
          <button type="submit" class="button pa2 bg-light-green hover-bg-green">Update</button>
          <span class="ml2"></span>
          <span class="gray">Submitted</span>
          {{else if $.TeamEvaluation.Valid}}
          <button type="submit" class="button pa2 bg-light-green hover-bg-green">Save Draft</button>
          <span class="ml2"></span>
          <button
            type="submit"
            formaction="{{$.SubmitURL}}"
            class="button pa2 bg-dark-green hover-bg-darker-green white"
            >
            Submit
          </button>
            {{else}}
            <button type="submit" class="button pa2 bg-light-green hover-bg-green">Create Draft</button>
            <span class="ml2"></span>
            {{end}}
        </div>
      </form>
    </div>
  </div>

  <!-- Scripts -->
  <script src="/static/tinymce/tinymce.min.js"></script>
  <script nonce="{{HeadersCSPNonce}}">
    tinymce.init({
      selector: "textarea",
      statusbar: false,
      menubar: false,
      toolbar: "bold italic bullist numlist table",
      plugins: "autoresize lists table",
    })
  </script>
  <!-- End Scripts -->
</body>
</html>
